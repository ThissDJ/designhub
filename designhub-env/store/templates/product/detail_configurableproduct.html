{% extends "product/product.html" %}
{% load i18n %}
{% load thumbnail %}
{% load satchmo_price %}
{% load satchmo_util %}
{% load satchmo_currency satchmo_category%}
{% load satchmo_discounts satchmo_tax %}
{% load app_plugins %}
{% load satchmo_thumbnail %}

{% block extra-head %}

{% include "shop/_jquery.html" %}
{% include "shop/_jquery_form.html" %}
<script type="text/javascript" src="{{ STATIC_URL }}js/satchmo_product.js"></script>
{% blackbird_logging %}
<script type="text/javascript">{# Javascript which is generated uniquely for each page #}
satchmo.default_view_tax = {% if default_view_tax %}true{% else %}false{% endif %};

satchmo.variations = {{ details|as_json }};

satchmo.set_option_ids([{% for option_group in options %}{{ option_group.id }}{% if not forloop.last %},{% endif %}{% endfor %}]);

$(function() {
    satchmo.update_price();
    $('.priced').change(function() { satchmo.update_price() });
});

// generate thumbnails for all alternate images
satchmo.thumbnails = new Array();
{{ details|js_thumbnail_array:"width=280,height=280" }}
</script>
{% endblock %}
{% block breadcrumbs-category %}
    {% include "product/product_path.html" with product=product %}
{% endblock breadcrumbs-category %}
{% block productdetail %}
    <div class="container" style="margin-top:10px;margin-bottom:20px;padding-bottom:20px;">

        <div style="width:540px;float:left;margin-bottom:100px;">
    		<div id="product">
    			<div class='content' >
	    	    <ul class="pagination">
	    			{% for pic in product.productimage_set.all %}
					    {% thumbnail pic.picture "80x120" crop='center' as image %}
					    <li>
					    	<a href="#" class="product-detail-thumnail" style='background:transparent;'>
					    	<img src="{{ image.url }}" />
					    </a>
					    </li>
					    {% endthumbnail %}
					{% endfor %}	    			
	    		</ul>
	    		</div>
	    		<div class="slides_container">
	    			{% for pic in product.productimage_set.all %}
	    			    {% thumbnail pic.picture "400x400" crop='center'  as image %}
					    {% thumbnail pic.picture "750x750" as image_b %}
					    <a class="fancybox-thumb zoom-in qtip-zoom-in" title='Click to enlarge' rel="fancybox-thumb" href="{{ image_b.url }}">
					    	<img src="{{ image.url }}"/>
					    </a>
					    {% endthumbnail %}
					    {% endthumbnail %}
					{% endfor %}
	    		</div>
	    	</div>
	    	<link href='http://fonts.googleapis.com/css?family=Nothing+You+Could+Do' rel='stylesheet' type='text/css'>
	    	<style>
	    		.sharing-label,.sharing-method, .say-something2designer{
	    			font-family: 'Nothing You Could Do', cursive;
	    		}
	    		.say-something2designer{
	    			font-size:18px;
	    		}
	    		.sharing-label{
	    			margin-right:10px;
	    		}
	    		.sharing-method{
	    			margin-right:8px;
	    		}
	    	</style>
	    	<script>
	    		function sendMail() {
				    var link = "mailto:?"
				             +"subject=" + escape("Share A Cool Stuff {{product.name}}")
				             + "&body=" + escape('http://{{ request.META.HTTP_HOST }}{{request.get_full_path}} ' + '{{product.description}}')
				    ;
				
				    window.location.href = link;
				}
	    	</script>
	    	<div class="clearfix"></div>
	    	<div style='margin-top:20px;margin-left:130px;'>
	    		<span class='sharing-label'>Share via:</span>
	    		<a class='sharing-method qtip-title-tip' title='Send to your friends' onclick="sendMail(); return false" href='javascript:void(0);'  target="_blank">Email</a>
	    		<a class='sharing-method qtip-title-tip' title='share this cool design with your friends in Facebook'  target="_blank" href='http://www.facebook.com/sharer.php?u=http%3A%2F%2F{{ request.META.HTTP_HOST }}{{request.get_full_path}}&t=DesignHub%20for%20local%creativity'>Facebook</a>
	    		<a class='sharing-method qtip-title-tip' title='share this cool design in Sina Weibo | 在微博上分享這次發現'  target="_blank" href='http://service.t.sina.com.cn/share/share.php?url=http%3A%2F%2F{{ request.META.HTTP_HOST }}{{request.get_full_path}}&title={{product.mynewproduct.brand.name}}%20%7C%20{{product.name}}%20by%20{{product.mynewproduct.designer.name}}'>Weibo</a>
	    		<a class='sharing-method qtip-title-tip' title='Tweet me' target="_blank" href='http://twitter.com/intent/tweet?url=http://{{ request.META.HTTP_HOST }}{{request.get_full_path}}&text={{product.description}};I love this design!&via=DesignHub.hk&related=designhub'>Twitter</a>
	    	</div>
    	</div>
    	<div style="width:420px;float:right;margin-bottom:70px;">
    		<div style='width:320px;margin-left:auto;margin-right:auto'>
    			<h3 style='text-align:center;'>{{ product.translated_name }}</h3>
                <h5 style='text-align:center;margin-bottom:0px;line-height:18px;'>{{ product.mynewproduct.brand.name }}</h5>
                <h5 style='text-align:center;font-style:italic;margin-top:0px;line-height:18px;color:#bbb;'>by <a href='#' style='font-size:14px;'>{{ product.mynewproduct.designer.name }}</a></h5>
                <div style='height:45px;'></div>
                {% if error_message %}<p><strong>{{ error_message }}</strong></p>{% endif %}
                
    			<div style='margin-bottom:35px;'>
					{% with product.translated_attributes as atts %}{% if atts %}
					<span class="productattributes">
					{% for att in product.translated_attributes %}
					{{ att.description }}: {{ att.value }}
					{% endfor %}
					</span>
					{% endif %}{% endwith %}
					
					{% if sale %}
						<span style='text-align:center;'>
							<strike id="fullprice" style="display: block;margin-bottom:7px;">{{ product|discount_price:""|currency }}</strike>
					    </span>
					{% endif %}
	                <form id="options" style='text-align:center;' class='form-inline' action="{% url satchmo_smart_add %}" method="post">{% csrf_token %}
	                	<span style='margin-right:5px;line-height:24px;'>{{ product|discount_price:sale|currency }}</span>	
		        		{% for option_group in options %}
		        		    <select id="{{option_group.id}}" class='span1' name="{{ option_group.id }}"style='font-size:12px;line-height:24px;' >
							    {% for choice in option_group.items %}
							        {% ifequal forloop.counter 1 %}
									     <option value="{{ choice.value }}" {% if choice.selected %}selected="selected"{% endif %}>{{ option_group.name }}:{{ choice.translated_name }}
									        {% if choice.price_change %}
									            {% option_price choice %}
									        {% endif %}
									     </option>
									{% else %}
									     <option value="{{ choice.value }}" {% if choice.selected %}selected="selected"{% endif %}>{{ choice.translated_name }}
									        {% if choice.price_change %}
									            {% option_price choice %}
									        {% endif %}
									     </option>
									{% endifequal %}
							    {% endfor %}
	                        </select>
		        		{% endfor %}
		        		<select id="quantity" class="span1" style='font-size:12px;line-height:24px;' name="quantity">
				            <option value='1' style='font-size:12px;line-height:24px;'>Qty:1</option>
				            <option value='2' style='font-size:12px;line-height:24px;'>2</option>
				            <option value='3' style='font-size:12px;line-height:24px;'>3</option>
				            <option value='4' style='font-size:12px;line-height:24px;'>4</option>
				            <option value='5' style='font-size:12px;line-height:24px;'>5</option>
	                    </select>

								<input type="hidden" name="productname" id="productname" value="{{product.slug}}" />
								<span style='margin-right:5px;line-height:24px;'>&nbsp;</span>
								<button class="btn btn-small btn-danger" id="addcart"  name="addcart"  type="submit">{% trans "Add to cart" %}</button>
					<input type="hidden" name="productname" id="productname" value="{{product.slug}}" />
					{% plugin_point "product_add_buttons" %}
					{% plugin_point "product_form" %}
					</form>
    			</div>
    			{% if product.mynewproduct.concept %}
    			<div style='margin-top:8px;margin-bottom:15px;'>
	    			<h5 style='margin-bottom:5px;'>Concept</h5>
	    			<p>
	    				{{product.mynewproduct.concept}}
	    			</p>
    		    </div>
    			{% endif %}
    			{% if product.description %}
    			<div style='margin-top:8px;margin-bottom:15px;'>
	    			<h5 style='margin-bottom:5px;'>Information</h5>
	    			<p>
	    				{{product.description}}
	    			</p>
	    		</div>
    			{% endif %}
    			<div style='margin-top:35px;'>
	                <form id="options2" style='text-align:center;' class='form-inline' action="{% url satchmo_smart_add %}" method="post">{% csrf_token %}
	                	<span style='margin-right:5px;line-height:24px;'>{{ product|discount_price:sale|currency }}</span>
		        		{% for option_group in options %}
		        		    <select id="{{option_group.id}}" class='span1' name="{{ option_group.id }}"style='font-size:12px;line-height:24px;' >
							    {% for choice in option_group.items %}
							        {% ifequal forloop.counter 1 %}
									     <option value="{{ choice.value }}" {% if choice.selected %}selected="selected"{% endif %}>{{ option_group.name }}:{{ choice.translated_name }}
									        {% if choice.price_change %}
									            {% option_price choice %}
									        {% endif %}
									     </option>
									{% else %}
									     <option value="{{ choice.value }}" {% if choice.selected %}selected="selected"{% endif %}>{{ choice.translated_name }}
									        {% if choice.price_change %}
									            {% option_price choice %}
									        {% endif %}
									     </option>
									{% endifequal %}
							    {% endfor %}
	                        </select>
		        		{% endfor %}
		        		<select id="quantity" class="span1" style='font-size:12px;line-height:24px;' name="quantity">
				            <option value='1' style='font-size:12px;line-height:24px;'>Qty:1</option>
				            <option value='2' style='font-size:12px;line-height:24px;'>2</option>
				            <option value='3' style='font-size:12px;line-height:24px;'>3</option>
				            <option value='4' style='font-size:12px;line-height:24px;'>4</option>
				            <option value='5' style='font-size:12px;line-height:24px;'>5</option>
	                    </select>

								<input type="hidden" name="productname" id="productname" value="{{product.slug}}" />
								<span style='margin-right:5px;line-height:24px;'>&nbsp;</span>
								<button class="btn btn-small btn-danger" id="addcart"  name="addcart"  type="submit">{% trans "Add to cart" %}</button>
					<input type="hidden" name="productname" id="productname" value="{{product.slug}}" />
					{% plugin_point "product_add_buttons" %}
					{% plugin_point "product_form" %}
					</form>
				</div>
    		</div>

    			
        </div>
        <div class="clearfix" ></div>
        <div style='width:60%;float:left;'>
        	{% include "product/designer.html" %}
        </div>
        <div style='width:40%;float:left;'>
        	{% if user.is_active %}
        	{% include "product/comments/form.html" %}
        	{% else %}
        	{% include "product/comments/login_form.html" %}
        	{% endif %}
        	{% include "product/comments/comments_list.html" %}
        </div>
        <div class="clearfix" ></div>
    	{% block productfooter %}
		<!--{% if sale %}{% include "product/product_discount_eligible.html" %}{% endif %}-->
		{% plugin_point "product_footer" %}
		{% endblock %}
    </div>

{% endblock %}
