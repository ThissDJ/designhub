{% extends "product/product.html" %}
{% load i18n %}
{% load thumbnail %}
{% load satchmo_price %}
{% load satchmo_util %}
{% load satchmo_currency satchmo_category%}
{% load satchmo_discounts satchmo_tax %}
{% load app_plugins %}
{% load satchmo_thumbnail %}

{% block extra-head %}

{% include "shop/_jquery.html" %}
{% include "shop/_jquery_form.html" %}
<script type="text/javascript" src="{{ STATIC_URL }}js/satchmo_product.js"></script>
{% blackbird_logging %}
<script type="text/javascript">{# Javascript which is generated uniquely for each page #}
satchmo.default_view_tax = {% if default_view_tax %}true{% else %}false{% endif %};

satchmo.variations = {{ details|as_json }};

satchmo.set_option_ids([{% for option_group in options %}{{ option_group.id }}{% if not forloop.last %},{% endif %}{% endfor %}]);

$(function() {
    satchmo.update_price();
    $('.priced').change(function() { satchmo.update_price() });
});

// generate thumbnails for all alternate images
satchmo.thumbnails = new Array();
{{ details|js_thumbnail_array:"width=280,height=280" }}
</script>
{% endblock %}
{% block breadcrumbs-category %}
    {% include "product/product_path.html" with product=product %}
{% endblock breadcrumbs-category %}
{% block productdetail %}
    <div class="container" style="margin-top:10px;margin-bottom:20px;padding-bottom:20px;">

        <div style="width:440px;float:left;margin-bottom:100px;">
    		<div id="product">
    			<div class='content' >
	    	    <ul class="pagination">
	    			{% for pic in product.productimage_set.all %}
					    {% thumbnail pic.picture "80x120" crop='center' as image %}
					    <li>
					    	<a href="#" class="product-detail-thumnail" style='background:transparent;'>
					    	{% if debug %}
					    	<img src="{{ image.url }}"  width="{{ image.width }}" height="{{ image.height }}"/>
					    	{% else %}
					    	<img src="{{MEDIA_URL}}images/index/none-80x120.jpg" />
					    	{% endif %}
					    </a>
					    </li>
					    {% endthumbnail %}
					{% endfor %}    			
	    		</ul>
	    		</div>
	    		<div class="slides_container">
	    			{% for pic in product.productimage_set.all %}
	    			    {% thumbnail pic.picture "300x400" crop='center'  as image %}
					    {% thumbnail pic.picture "1000x1334" crop='center' as image_b %}
					    {% if debug %}
					    <a class="fancybox-thumb zoom-in qtip-zoom-in" title='Click to enlarge' rel="fancybox-thumb" data-bigimage-src='{{ image_b.url }}' href="#">
					    	<img src="{{ image.url }}" width="{{ image.width }}" height="{{ image.height }}"/>
					    {% else %}
					    <a class="fancybox-thumb zoom-in qtip-zoom-in" title='Click to enlarge' rel="fancybox-thumb" data-bigimage-src='{{MEDIA_URL}}images/index/none-1000x1334.jpg' href="#">
					    	<img src="{{MEDIA_URL}}images/index/none-300x400.jpg" width="300" height="400"/>
                        {% endif %} 
					    </a>
					    {% endthumbnail %}
					    {% endthumbnail %}
					{% endfor %}
					<div class="hidden"> <!-- preload big images -->
						<script type="text/javascript">
							<!--//--><![CDATA[//><!--
								function preloaderZoomIn() {
									if (document.images) {
										var virtualImgsZoomIn = new Array();
										{% for pic in product.productimage_set.all %}
										    {% thumbnail pic.picture "1000x1334" crop='center' as image_b %}
										        var virtualImgZoomIn = new Image();
										        virtualImgZoomIn.src = '{{image_b.url}}'
										        virtualImgsZoomIn.push(virtualImgZoomIn);
										    {% endthumbnail %}
										{% endfor %}
									}
								}
								function addLoadEvent(func) {
									var oldonload = window.onload;
									if (typeof window.onload != 'function') {
										window.onload = func;
									} else {
										window.onload = function() {
											if (oldonload) {
												oldonload();
											}
											func();
										}
									}
								}
								addLoadEvent(preloaderZoomIn);
							//--><!]]>
						</script>
					</div>
	    		</div>
	    	</div>
	    	<link href='https://fonts.googleapis.com/css?family=Nothing+You+Could+Do' rel='stylesheet' type='text/css'>
	    	<style>
	    		.say-something2designer{
	    			font-family: 'Nothing You Could Do', cursive;
	    			font-size:18px;
	    		}
	    	</style>
	    	<div class="clearfix"></div>
	    	{% include 'product/sharing-buttons.html' with product=product %}
    	</div>
    	<div style="width:510px;float:right;margin-bottom:70px;">
    		<div style='width:470px;margin-left:auto;margin-right:0;'>
    			<h3 style='text-align:center;'>{{ product.translated_name }}</h3>
                <h5 style='text-align:center;margin-bottom:0px;line-height:18px;'>{{ product.mynewproduct.brand.name }}</h5>
                <h5 style='text-align:center;font-style:italic;margin-top:0px;line-height:18px;color:#bbb;'>by <a href='{{ product.mynewproduct.designer.get_absolute_url}}' style='font-size:14px;'>{{ product.mynewproduct.designer.name }}</a></h5>
                <div style='height:45px;'></div>
                {% if error_message %}<p><strong>{{ error_message }}</strong></p>{% endif %}
                
    			<div style='margin-bottom:35px;'>
					{% with product.translated_attributes as atts %}{% if atts %}
					<span class="productattributes">
					{% for att in product.translated_attributes %}
					{{ att.description }}: {{ att.value }}
					{% endfor %}
					</span>
					{% endif %}{% endwith %}
					
					{% if sale %}
						<span style='text-align:center;'>
							<strike id="fullprice" style="display: block;margin-bottom:7px;">{{ product|discount_price:""|currency }}</strike>
					    </span>
					{% endif %}
					{% if product.mynewproduct.preorder %}
					    <div style='text-align:center'>
					    	<span class='label'>Pre-order Item</span>
					    </div>
					    <div style='text-align:center;margin-bottom:18px;'>
							<span>
								Pre-order campaign ending on <span style='text-decoration:underline;'>{{ product.mynewproduct.end }}</span>
							</span>
					    </div>
					{% endif %}
	                <form id="options" style='text-align:center;' class='form-inline' action="{% url satchmo_smart_add %}" method="post">{% csrf_token %}
	                	<span style='margin-right:5px;line-height:24px;'>{{ product|discount_price:sale|currency }}</span>	
		        		{% for option_group in options %}
		        		    <select id="{{option_group.id}}" class='span1' name="{{ option_group.id }}"style='font-size:12px;line-height:24px;' >
							    {% for choice in option_group.items %}
							        {% ifequal forloop.counter 1 %}
									     <option value="{{ choice.value }}" {% if choice.selected %}selected="selected"{% endif %}>{{ option_group.name }}:{{ choice.translated_name }}
									        {% if choice.price_change %}
									            {% option_price choice %}
									        {% endif %}
									     </option>
									{% else %}
									     <option value="{{ choice.value }}" {% if choice.selected %}selected="selected"{% endif %}>{{ choice.translated_name }}
									        {% if choice.price_change %}
									            {% option_price choice %}
									        {% endif %}
									     </option>
									{% endifequal %}
							    {% endfor %}
	                        </select>
		        		{% endfor %}
		        		<select id="quantity" class="span1" style='font-size:12px;line-height:24px;' name="quantity">
				            <option value='1' style='font-size:12px;line-height:24px;'>Qty:1</option>
				            <option value='2' style='font-size:12px;line-height:24px;'>2</option>
				            <option value='3' style='font-size:12px;line-height:24px;'>3</option>
				            <option value='4' style='font-size:12px;line-height:24px;'>4</option>
				            <option value='5' style='font-size:12px;line-height:24px;'>5</option>
	                    </select>

								<input type="hidden" name="productname" id="productname" value="{{product.slug}}" />
								<span style='margin-right:5px;line-height:24px;'>&nbsp;</span>
								<button class="btn btn-small btn-danger" id="addcart"  name="addcart"  type="submit">{% trans "Add to cart" %}</button>
					<input type="hidden" name="productname" id="productname" value="{{product.slug}}" />
					{% plugin_point "product_add_buttons" %}
					{% plugin_point "product_form" %}
					</form>
    			</div>
    			{% include 'product/product-info-tabs.html' with product=product %}
    			<div style='margin-top:35px;'>
	                <form id="options2" style='text-align:center;' class='form-inline' action="{% url satchmo_smart_add %}" method="post">{% csrf_token %}
	                	<span style='margin-right:5px;line-height:24px;'>{{ product|discount_price:sale|currency }}</span>
		        		{% for option_group in options %}
		        		    <select id="{{option_group.id}}" class='span1' name="{{ option_group.id }}"style='font-size:12px;line-height:24px;' >
							    {% for choice in option_group.items %}
							        {% ifequal forloop.counter 1 %}
									     <option value="{{ choice.value }}" {% if choice.selected %}selected="selected"{% endif %}>{{ option_group.name }}:{{ choice.translated_name }}
									        {% if choice.price_change %}
									            {% option_price choice %}
									        {% endif %}
									     </option>
									{% else %}
									     <option value="{{ choice.value }}" {% if choice.selected %}selected="selected"{% endif %}>{{ choice.translated_name }}
									        {% if choice.price_change %}
									            {% option_price choice %}
									        {% endif %}
									     </option>
									{% endifequal %}
							    {% endfor %}
	                        </select>
		        		{% endfor %}
		        		<select id="quantity" class="span1" style='font-size:12px;line-height:24px;' name="quantity">
				            <option value='1' style='font-size:12px;line-height:24px;'>Qty:1</option>
				            <option value='2' style='font-size:12px;line-height:24px;'>2</option>
				            <option value='3' style='font-size:12px;line-height:24px;'>3</option>
				            <option value='4' style='font-size:12px;line-height:24px;'>4</option>
				            <option value='5' style='font-size:12px;line-height:24px;'>5</option>
	                    </select>

								<input type="hidden" name="productname" id="productname" value="{{product.slug}}" />
								<span style='margin-right:5px;line-height:24px;'>&nbsp;</span>
								<button class="btn btn-small btn-danger" id="addcart"  name="addcart"  type="submit">{% trans "Add to cart" %}</button>
					<input type="hidden" name="productname" id="productname" value="{{product.slug}}" />
					{% plugin_point "product_add_buttons" %}
					{% plugin_point "product_form" %}
					</form>
				</div>
    		</div>

    			
        </div>
        <div class="clearfix" ></div>
        <div style='width:60%;float:left;'>
        	{% include "product/designer.html" %}
        </div>
        <div style='width:40%;float:left;'>
        	{% if user.is_active %}
        	{% include "product/comments/form.html" %}
        	{% else %}
        	{% include "product/comments/login_form.html" %}
        	{% endif %}
        	{% include "product/comments/comments_list.html" %}
        </div>
        <div class="clearfix" ></div>
    	{% block productfooter %}
		<!--{% if sale %}{% include "product/product_discount_eligible.html" %}{% endif %}-->
		{% plugin_point "product_footer" %}
		{% endblock %}
    </div>

{% endblock %}
